# Property definitions

The src subdirectory contains source files for property definitions for the standard OPTIMADE properties.
They are organized with one subdirectory per OPTIMADE endpoint, and one directory `common` for common definitions used across multiple endpoints.

The source files are formatted in YAML to be human-editable and use JSON Schema pointers to avoid duplication of information.

The source files can be compiled into standard JSON-formatted property definitions by the command:
```
make properties
```
The JSON-formatted (and thus JSON Schema-compatible) output files are placed in the output directory.
Note that this process replaces the JSON Schema pointers by inline copies of the corresponding definitions to adhere to the OPTIMADE standard for property definitions.

## Stable Property Definition URIs

Properties are given URIs that are stable URLs with the following format:
```
  https://schemas.optimade.org/properties/{version}/optimade/{endpoint}/{property id}
```
Where:

- `{version}` is the property definition version prefixed with a `v`, which per definition coincide with the full OPTIMADE version where the property definition was last changed (see below), e.g., `v1.2.0`.
- `{endpoint}` is the endpoint to which the property is designated in OPTIMADE.
- `{property id}` the id that identifies the property.

The following URL references a compound JSON document collecting all property definitions that belong to the same endpoint:
```
  https://schemas.optimade.org/properties/{version}/optimade/{endpoint}
```
The following URL references a compound JSON document collecting all definitions that belong to all the endpoints:
```
  https://schemas.optimade.org/properties/{version}/optimade
```

A URI used to reference property definition MUST always use a URL with the full version number, including the major, minor, and patch version segments.

## Other useful URLs

The URLs in the following section are NOT intended for use as stable URIs to reference property definitions.
They are meant to provide easy access to updated relevant information to locate relevant property definitions.

The following URL references a compound JSON document of property definitons that is kept updated to cover all properties that belong to the latest patch release of a specific *minor* version of OPTIMADE:
```
  https://schemas.optimade.org/properties/{minor version}/optimade
```
where `{minor version}` is an OPTIMADE major.minor version prefixed with a `v`, e.g., `v1.2`.

Similarly, the following URL is a compound JSON document kept updated to cover all properties that belong to the latest minor and patch release for a *major* version of OPTIMADE:
```
  https://schemas.optimade.org/properties/{major version}/optimade
```
where `{major version}` is an OPTIMADE major version prefixed with a `v`, e.g., `v1`.

To further simlify locating a relevant property definition, the following URLs resolve to a valid JSON Schema document, but which are NOT property definitions, containing a '$ref' pointer to the most recent property definition for the respective minor and major version of OPTIMADE:
```
  https://schemas.optimade.org/properties/{minor version}/optimade/optimade/{endpoint}/{property id}
  https://schemas.optimade.org/properties/{major version}/optimade/optimade/{endpoint}/{property id}
```

## Versioning of property definitions

Property definitions need to have URIs that are kept as static as possible.
Hence, their versions stay fixed at the precise OPTIMADE patch release version in which they were modified last.
Further releases of OPTIMADE in which a property definition is not changed thus retain that property at the same version.

Exactly which property definitions are part of a specific version of OPTIMADE can be located using the URLs in the preceeding section or in the files generated by `make properties`.

For example, a full list of the property definitions (including their version numbers) that are part of OPTIMADE version 1.2.0 are found at:
```
  https://schemas.optimade.org/properties/v1.2.0/optimade
```
The same information is also found at the path: `properties/v1.2.0/optimade.json` after executing `make properties` in this repository.
